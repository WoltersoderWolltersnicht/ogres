<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8">
        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ§…</text></svg>">
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="Free online virtual tabletop">
        <meta name="og:title" content="Ogres &ndash; Play: Free online virtual tabletop">
        <meta name="og:type" content="website">
        <meta name="og:url" content="https://ogres.app">
        <meta name="og:image" content="https://ogres.app/screenshot.png">
        <meta name="og:description" content="Free online virtual tabletop">
        <title>Ogres &ndash; Play: Free online virtual tabletop</title>
        <script src="https://unpkg.com/dexie@3.2.2/dist/dexie.min.js"></script>
        <script>
            function initialize(path) {
                let element = document.createElement("script");
                element.type = "text/javascript";
                element.src = path + "/ogres.app.js";
                document.head.appendChild(element);
            }

            // Initializes the application at the correct version by searching
            // your browser's local storage for a record that was put there
            // when you previously used this site. If this is your first time
            // visiting, it initializes the application with the latest stable
            // release.
            function main() {
                // This checks to see if this application is being run locally
                // for development and loads from a special directory instead.
                if (window.location.hostname === "localhost") {
                    initialize("release");
                    return;
                }

                // By adding a search parameter to the URL, the client can
                // request to load a release at the specified directory name.
                let params = new URLSearchParams(window.location.search);
                if (params.get("r")) {
                    initialize("release/" + params.get("r"));
                    return;
                }

                // Search for a record in local storage and load the release
                // specified by it. When no record is found, initialize the
                // "latest" release instead.
                let db = new Dexie("ogres.app");
                db.version(1).stores({app: "release, updated", images: "checksum"});
                db.table("app").orderBy("updated").first().then(function (record) {
                    if (!record) {
                        initialize("release/latest");
                        return;
                    }

                    initialize("release/" + record.release);
                });
            }

            document.addEventListener("DOMContentLoaded", main);
        </script>
    </head>
    <body>
        <div id="root" />
    </body>
</html>
